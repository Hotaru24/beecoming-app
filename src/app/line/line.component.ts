import { Component, OnInit } from '@angular/core';
import { Chart } from 'chart.js';
import axios from 'axios';

@Component({
  selector: 'app-line',
  templateUrl: './line.component.html',
  styleUrls: ['./line.component.css']
})
export class LineComponent implements OnInit {

  constructor() { }

  

  ngOnInit(): void {
   let apiData : any[] = [{"2021-01-01": 29391.775, "2021-01-02": 32198.48, "2021-01-03": 33033.62, "2021-01-04": 32017.565, "2021-01-05": 34035.0067, "2021-01-06": 36826.9783, "2021-01-07": 39475.6067, "2021-01-08": 40616.7217, "2021-01-09": 40227.8683, "2021-01-10": 38191.55, "2021-01-11": 35463.1883, "2021-01-12": 34059.9133, "2021-01-13": 37375.8033, "2021-01-14": 39138.075, "2021-01-15": 36770.0433, "2021-01-16": 36029.1967, "2021-01-17": 35845.0217, "2021-01-18": 36656.9933, "2021-01-19": 35929.1683, "2021-01-20": 35510.67, "2021-01-21": 30838.5, "2021-01-22": 33018.825, "2021-01-23": 32106.7033, "2021-01-24": 32297.165, "2021-01-25": 32255.35, "2021-01-26": 32518.3583, "2021-01-27": 30425.3933, "2021-01-28": 33420.045, "2021-01-29": 34264.01, "2021-01-30": 34324.2717, "2021-01-31": 33129.7433, "2021-02-01": 33543.77, "2021-02-02": 35528.31, "2021-02-03": 37685.2767, "2021-02-04": 36984.6783, "2021-02-05": 38306.2467, "2021-02-06": 39269.3417, "2021-02-07": 38862.35, "2021-02-08": 46436.09, "2021-02-09": 46502.2933, "2021-02-10": 44855.6167, "2021-02-11": 48004.6533, "2021-02-12": 47410.4033, "2021-02-13": 47211.6683, "2021-02-14": 48633.26, "2021-02-15": 47934.1267, "2021-02-16": 49185.7283, "2021-02-17": 52127.32, "2021-02-18": 51573.4067, "2021-02-19": 55923.13, "2021-02-20": 55898.44, "2021-02-21": 57441.6, "2021-02-22": 54117.495, "2021-02-23": 48901.0167, "2021-02-24": 49734.52, "2021-02-25": 47104.7833, "2021-02-26": 46329.74, "2021-02-27": 46189.3783, "2021-02-28": 45256.4133, "2021-03-01": 49619.6433, "2021-03-02": 48502.8083, "2021-03-03": 50422.1683, "2021-03-04": 48365.145, "2021-03-05": 48780.96, "2021-03-06": 48887.0233, "2021-03-07": 50985.9417, "2021-03-08": 52393.36, "2021-03-09": 54932.3367, "2021-03-10": 55890.255, "2021-03-11": 57827.6133, "2021-03-12": 57254.9, "2021-03-13": 61184.8267, "2021-03-14": 58991.5683, "2021-03-15": 55652.0067, "2021-03-16": 56921.495, "2021-03-17": 58899.975, "2021-03-18": 57638.09, "2021-03-19": 58069.2567, "2021-03-20": 58119.0917, "2021-03-21": 57372.9783, "2021-03-22": 54091.9683, "2021-03-23": 54343.355, "2021-03-24": 52291.855 }];

    axios.get('https://api.coindesk.com/v1/bpi/historical/close.json?start=2021-01-01&end=2021-03-25 ')
    .then((result) => {
      apiData = [result.data.bpi]
    })
    .catch( (error) => {
      console.log(`Can't GET API - ${error}`)
    });

    let apiValues : any[] = [...Object.values(apiData[0])];
    let apiKeys : any[] = [...Object.keys(apiData[0])];

    console.log(apiData)
    let myChart = new Chart("myChart", {
      type: 'line',
      data: {
        labels: [...apiKeys],
        datasets: [{
          label: 'Bitcoin evolution in 2021',
          data: [...apiValues],
        }]
      }
    }); 
  } 




}



